
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../multi_level_columns/">
      
      
        <link rel="next" href="../../development/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Price Repair - Yahoo Finance Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/chat.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#price-repair" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Yahoo Finance Docs" class="md-header__button md-logo" aria-label="Yahoo Finance Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Yahoo Finance Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Price Repair
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Yahoo Finance Docs" class="md-nav__button md-logo" aria-label="Yahoo Finance Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Yahoo Finance Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    yfinance documentation
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CODE_OF_CONDUCT/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code of Conduct
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Advanced
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../caching/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Caching
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../multi_level_columns/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multi-Level Column Index
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Price Repair
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Price Repair
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#price-repair_1" class="md-nav__link">
    <span class="md-ellipsis">
      Price repair
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Price repair">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#missing-dividend-adjustment" class="md-nav__link">
    <span class="md-ellipsis">
      Missing dividend adjustment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-split-adjustment" class="md-nav__link">
    <span class="md-ellipsis">
      Missing split adjustment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-data" class="md-nav__link">
    <span class="md-ellipsis">
      Missing data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#100x-errors" class="md-nav__link">
    <span class="md-ellipsis">
      100x errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#price-reconstruction-algorithm-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Price reconstruction - algorithm notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dividend-repair-new" class="md-nav__link">
    <span class="md-ellipsis">
      Dividend repair (new)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dividend repair (new)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#important-false-positives" class="md-nav__link">
    <span class="md-ellipsis">
      IMPORTANT - false positives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjustment-missing" class="md-nav__link">
    <span class="md-ellipsis">
      Adjustment missing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjustment-too-small" class="md-nav__link">
    <span class="md-ellipsis">
      Adjustment too small
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicate-within-7-days" class="md-nav__link">
    <span class="md-ellipsis">
      Duplicate (within 7 days)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dividend-too-big" class="md-nav__link">
    <span class="md-ellipsis">
      Dividend too big
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dividend-adjust-too-big" class="md-nav__link">
    <span class="md-ellipsis">
      Dividend &amp; adjust too big
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dividend-too-small" class="md-nav__link">
    <span class="md-ellipsis">
      Dividend too small
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjusted-2x-on-day-before" class="md-nav__link">
    <span class="md-ellipsis">
      Adjusted 2x on day before
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ex-div-date-wrong" class="md-nav__link">
    <span class="md-ellipsis">
      ex-div date wrong
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/code/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Code
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/documentation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/running/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Running a branch
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../development/testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Unit Tests
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.analysis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Analysis &amp; Holdings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.financials/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Financials
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.functions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Functions and Utilities
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.funds_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FundsData class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.market/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Market
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.price_history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PriceHistory class
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.screener/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Screener &amp; Query
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.search/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Search &amp; Lookup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.sector_industry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sector and Industry
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.stock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Stock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.ticker_tickers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ticker and Tickers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/yfinance.websocket/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WebSocket
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tutorial: yfinance
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/01_ticker_object_/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 1: The Ticker Object
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/02_multi_ticker_operations_/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 2: Multi-Ticker Operations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/03_screener___query_objects_/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 3: Screener &amp; Query Objects
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/04_websocket__live_data_streaming__/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 4: WebSocket (Live Data Streaming)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/05_domain_entities__sector__industry__market__/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 5: Domain Entities (Sector, Industry, Market)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/06_yfdata__data_fetching_layer__/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 6: YfData (Data Fetching Layer)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorial/07_data_scrapers_/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chapter 7: Data Scrapers
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#price-repair_1" class="md-nav__link">
    <span class="md-ellipsis">
      Price repair
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Price repair">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#missing-dividend-adjustment" class="md-nav__link">
    <span class="md-ellipsis">
      Missing dividend adjustment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-split-adjustment" class="md-nav__link">
    <span class="md-ellipsis">
      Missing split adjustment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#missing-data" class="md-nav__link">
    <span class="md-ellipsis">
      Missing data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#100x-errors" class="md-nav__link">
    <span class="md-ellipsis">
      100x errors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#price-reconstruction-algorithm-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Price reconstruction - algorithm notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dividend-repair-new" class="md-nav__link">
    <span class="md-ellipsis">
      Dividend repair (new)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Dividend repair (new)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#important-false-positives" class="md-nav__link">
    <span class="md-ellipsis">
      IMPORTANT - false positives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjustment-missing" class="md-nav__link">
    <span class="md-ellipsis">
      Adjustment missing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjustment-too-small" class="md-nav__link">
    <span class="md-ellipsis">
      Adjustment too small
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#duplicate-within-7-days" class="md-nav__link">
    <span class="md-ellipsis">
      Duplicate (within 7 days)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dividend-too-big" class="md-nav__link">
    <span class="md-ellipsis">
      Dividend too big
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dividend-adjust-too-big" class="md-nav__link">
    <span class="md-ellipsis">
      Dividend &amp; adjust too big
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dividend-too-small" class="md-nav__link">
    <span class="md-ellipsis">
      Dividend too small
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adjusted-2x-on-day-before" class="md-nav__link">
    <span class="md-ellipsis">
      Adjusted 2x on day before
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ex-div-date-wrong" class="md-nav__link">
    <span class="md-ellipsis">
      ex-div date wrong
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="price-repair">Price Repair</h1>
<p>The new argument <code>repair=True</code> in <code>history()</code> and <code>download()</code> will
attempt to fix a variety of price errors caused by Yahoo. Only US market
data appears perfect, I guess Yahoo doesn't care much about rest of
world?</p>
<p>The returned table will have a new column <code>Repaired?</code> that specifies if
row was repaired.</p>
<h2 id="price-repair_1">Price repair</h2>
<h3 id="missing-dividend-adjustment">Missing dividend adjustment</h3>
<p>If dividend in data but preceding <code>Adj Close</code> = <code>Close</code>, then manually
apply dividend-adjustment to <code>Adj Close</code>. Note: <code>Repaired?</code> is NOT set
to <code>True</code> because fix only changes <code>Adj Close</code></p>
<figure>
<img src="/_static/images/repair-prices-missing-div-adjust.png"
class="align-left" style="width:80.0%"
alt="/_static/images/repair-prices-missing-div-adjust.png" />
<figcaption>8TRA.DE</figcaption>
</figure>

<h3 id="missing-split-adjustment">Missing split adjustment</h3>
<p>If stock split in data but preceding price data is not adjusted, then
manually apply stock split. Requires date range include 1 day after
stock split for calibration - sometimes Yahoo fails to adjust prices on
stock split day.</p>
<figure>
<img src="/_static/images/repair-prices-missing-split-adjust.png"
class="align-left" style="width:80.0%"
alt="/_static/images/repair-prices-missing-split-adjust.png" />
<figcaption>MOB.ST</figcaption>
</figure>

<h3 id="missing-data">Missing data</h3>
<p>If price data is clearly missing or corrupt, then reconstructed using
smaller interval e.g. <code>1h</code> to fix <code>1d</code> data.</p>
<figure>
<img src="/_static/images/repair-prices-missing-row.png"
class="align-left" style="width:80.0%"
alt="/_static/images/repair-prices-missing-row.png" />
<figcaption>1COV.DE missing row</figcaption>
</figure>

<figure>
<img src="/_static/images/repair-prices-missing-volume-intraday.png"
class="align-left" style="width:80.0%"
alt="/_static/images/repair-prices-missing-volume-intraday.png" />
<figcaption>1COV.DE missing Volume, but intraday price
changed</figcaption>
</figure>

<figure>
<img src="/_static/images/repair-prices-missing-volume-daily.png"
class="align-left" style="width:80.0%"
alt="/_static/images/repair-prices-missing-volume-daily.png" />
<figcaption>0316.HK missing Volume, but daily price changed</figcaption>
</figure>

<h3 id="100x-errors">100x errors</h3>
<p>Sometimes Yahoo mixes up currencies e.g. \$/cents or £/pence. So some
prices are 100x wrong. Sometimes they are spread randomly through data -
these detected with <code>scipy</code> module. Other times they are in a block,
because Yahoo decided one day to permanently switch currency.</p>
<figure>
<img src="/_static/images/repair-prices-100x.png" class="align-left"
style="width:80.0%" alt="/_static/images/repair-prices-100x.png" />
<figcaption>AET.L</figcaption>
</figure>

<h3 id="price-reconstruction-algorithm-notes">Price reconstruction - algorithm notes</h3>
<p>Spam minimised by grouping fetches. Tries to be aware of data limits
e.g. <code>1h</code> cannot be fetched beyond 2 years.</p>
<p>If Yahoo eventually does fix the bad data that required reconstruction,
you will see it's slightly different to reconstructed prices and volume
often significantly different. Best I can do, and beats missing data.</p>
<h2 id="dividend-repair-new">Dividend repair (new)</h2>
<p>Fix errors in dividends:</p>
<ol>
<li>adjustment missing or 100x too small/big for the dividend</li>
<li>duplicate dividend (within 7 days)</li>
<li>dividend 100x too big/small for the ex-dividend price drop</li>
<li>ex-div date wrong (price drop is few days/weeks after)</li>
</ol>
<p>Most errors I've seen are on London stock exchange (£/pence mixup), but
no exchange is safe.</p>
<h3 id="important-false-positives">IMPORTANT - false positives</h3>
<p>Because fixing (3) relies on price action, there is a chance of a
"false positive" (FP) - thinking an error exists when data is good. FP
rate increases with longer intervals, so only 1d intervals are repaired.
If you request repair on multiday intervals (weekly etc), then: 1d is
fetched from Yahoo, repaired, then resampled - <strong>this has nice
side-effect of solving Yahoo's flawed way of div-adjusting multiday
intervals.</strong></p>
<p>FP rate on 1d is tiny. They tend to happen with tiny dividends e.g.
0.5%, mistaking normal price volatility for an ex-div drop 100x bigger
than the dividend, causing repair of the "too small" dividend (repair
logic already tries to account for normal volatility by subtracting
median). Either accept the risk, or fetch 6-12 months of prices with at
least 2 dividends - then can analyse the dividends together to identify
false positives.</p>
<h3 id="adjustment-missing">Adjustment missing</h3>
<p>1398.HK</p>
<pre><code class="language-text"># ORIGINAL:
                           Close  Adj Close  Dividends
2024-07-08 00:00:00+08:00   4.33       4.33   0.335715
2024-07-04 00:00:00+08:00   4.83       4.83   0.000000
</code></pre>
<pre><code class="language-text"># REPAIRED:
                           Close  Adj Close  Dividends
2024-07-08 00:00:00+08:00   4.33   4.330000   0.335715
2024-07-04 00:00:00+08:00   4.83   4.494285   0.000000
</code></pre>
<h3 id="adjustment-too-small">Adjustment too small</h3>
<p>3IN.L</p>
<pre><code class="language-text"># ORIGINAL:
                           Close  Adj Close  Dividends
2024-06-13 00:00:00+01:00  3.185   3.185000    0.05950
2024-06-12 00:00:00+01:00  3.270   3.269405    0.00000
</code></pre>
<pre><code class="language-text"># REPAIRED:
                           Close  Adj Close  Dividends
2024-06-13 00:00:00+01:00  3.185   3.185000    0.05950
2024-06-12 00:00:00+01:00  3.270   3.210500    0.00000
</code></pre>
<h3 id="duplicate-within-7-days">Duplicate (within 7 days)</h3>
<p>ALC.SW</p>
<pre><code class="language-text"># ORIGINAL:
                               Close  Adj Close  Dividends
2023-05-10 00:00:00+02:00  70.580002  70.352142       0.21
2023-05-09 00:00:00+02:00  65.739998  65.318443       0.21
2023-05-08 00:00:00+02:00  66.379997  65.745682       0.00
</code></pre>
<pre><code class="language-text"># REPAIRED:
                               Close  Adj Close  Dividends
2023-05-10 00:00:00+02:00  70.580002  70.352142       0.00
2023-05-09 00:00:00+02:00  65.739998  65.527764       0.21
2023-05-08 00:00:00+02:00  66.379997  65.956371       0.00
</code></pre>
<h3 id="dividend-too-big">Dividend too big</h3>
<p>HLCL.L</p>
<pre><code class="language-text"># ORIGINAL:
                           Close  Adj Close  Dividends
2024-06-27 00:00:00+01:00  2.360     2.3600       1.78
2024-06-26 00:00:00+01:00  2.375     2.3572       0.00

# REPAIRED:
                           Close  Adj Close  Dividends
2024-06-27 00:00:00+01:00  2.360     2.3600     0.0178
2024-06-26 00:00:00+01:00  2.375     2.3572     0.0000
</code></pre>
<h3 id="dividend-adjust-too-big">Dividend &amp; adjust too big</h3>
<p>LTI.L</p>
<pre><code class="language-text"># ORIGINAL:
                           Close  Adj Close     Adj  Dividends
2024-08-08 00:00:00+01:00  768.0      768.0  1.0000     5150.0
2024-08-07 00:00:00+01:00  819.0    -4331.0 -5.2882        0.0
                           Close  Adj Close     Adj  Dividends
2024-08-08 00:00:00+01:00  768.0      768.0  1.0000       51.5
2024-08-07 00:00:00+01:00  819.0      767.5  0.9371        0.0
</code></pre>
<h3 id="dividend-too-small">Dividend too small</h3>
<p>BVT.L</p>
<pre><code class="language-text"># ORIGINAL:
                            Close  Adj Close     Adj  Dividends
2022-02-03 00:00:00+00:00  0.7534   0.675197  0.8962    0.00001
2022-02-01 00:00:00+00:00  0.7844   0.702970  0.8962    0.00000
</code></pre>
<pre><code class="language-text"># REPAIRED:
                            Close  Adj Close     Adj  Dividends
2022-02-03 00:00:00+00:00  0.7534   0.675197  0.8962      0.001
2022-02-01 00:00:00+00:00  0.7844   0.702075  0.8950      0.000
</code></pre>
<h3 id="adjusted-2x-on-day-before">Adjusted 2x on day before</h3>
<p>clue: Close \&lt; Low</p>
<p>2020.OL</p>
<pre><code class="language-text"># ORIGINAL:
                                  Low       Close   Adj Close  Dividends
2023-12-21 00:00:00+01:00  120.199997  121.099998  118.868782       0.18
2023-12-20 00:00:00+01:00  122.000000  121.900002  119.477371       0.00
</code></pre>
<pre><code class="language-text"># REPAIRED:
                                  Low       Close   Adj Close  Dividends
2023-12-21 00:00:00+01:00  120.199997  121.099998  118.868782       0.18
2023-12-20 00:00:00+01:00  122.000000  122.080002  119.654045       0.00
</code></pre>
<h3 id="ex-div-date-wrong">ex-div date wrong</h3>
<p>TETY.ST</p>
<pre><code class="language-text"># ORIGINAL:
                               Close  Adj Close  Dividends
2022-06-22 00:00:00+02:00  66.699997  60.085415        0.0
2022-06-21 00:00:00+02:00  71.599998  64.499489        0.0
2022-06-20 00:00:00+02:00  71.800003  64.679657        5.0
2022-06-17 00:00:00+02:00  71.000000  59.454838        0.0
</code></pre>
<pre><code class="language-text"># REPAIRED:
                               Close  Adj Close  Dividends
2022-06-22 00:00:00+02:00  66.699997  60.085415        5.0
2022-06-21 00:00:00+02:00  71.599998  60.007881        0.0
2022-06-20 00:00:00+02:00  71.800003  60.175503        0.0
2022-06-17 00:00:00+02:00  71.000000  59.505021        0.0
</code></pre>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/chat-config.js"></script>
      
        <script src="../../js/chat.js"></script>
      
    
  </body>
</html>